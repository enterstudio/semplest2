@model IEnumerable<SemplestModel.Role>

@{
    ViewBag.Title = "Index";
}
@section Title{
Security
}
@section Navbar{
    <script src="@Url.Content("~/Scripts/PanelBar.js")" type="text/javascript"></script>
}
@section Links{
    @Html.Partial("TopMenu")
}
<p>
    @Html.ActionLink("System Defaults", "../Configuration") |
    @Html.ActionLink("Security", "../Roles") 
</p>
<h2>Security</h2>
@Html.ActionLink("Add Role", "Create")
<fieldset>
@*<p>
    @Html.ActionLink("Create New", "Create")
</p>*@
<table>
    <tr>
        <th>
            RoleName
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
        @Html.Label(item.RoleName)  
        @Html.ActionLink("Edit", "Edit", new { id = item.RolePK })
        @if(item.UserRolesAssociations.Count() >0)
        {
            @Html.DisplayText("Delete");
        }
        else
        {
            @Html.ActionLink("Delete", "Delete", new { id = item.RolePK }, new { @class = "delete", id = item.RolePK })
        }

        </td>

    </tr>
}
</table>


</fieldset>
<div style="display:none;">
<form name="hiddenButton" id="hiddenButton" action="/Roles/Delete" method="post">Are you sure you want to delete this role?<br /><input type="button" id="btnYes"  value="Yes" class="k-button"/><input type="hidden" id="id" name="id" /><input type="button" id="btnNo"  value="No" class="k-button"/></form>
</div>

<script language="javascript">    $(document).ready(function () {
        $(".delete").click(function (event) {
            $('#id').val(event.target.id);
            $.blockUI(({ message: $('#hiddenButton') }));
            event.preventDefault();
        });

        $("#btnYes").click(function (event) {
            $("#hiddenButton").submit();
        });

        $("#btnNo").click(function (event) {
            $.unblockUI();
        });

    });
</script>