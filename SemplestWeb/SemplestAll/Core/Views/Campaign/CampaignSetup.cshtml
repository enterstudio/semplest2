
@using System.Globalization
@using SemplestModel
@model Semplest.Core.Models.CampaignSetupModel
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"> </script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.js")" type="text/javascript"> </script>
<script src="@Url.Content("~/Scripts/conditional-validation.js")" type="text/javascript"></script>
@Html.AntiForgeryToken()
@{
    ViewBag.Title = "Campaign";
    Layout = "~/Views/Campaign/_Layout.cshtml";
}
<style>
    .enddate
    {
        display: none;
        visibility: hidden;
    }
    .expand-padding
    {
        padding-right: 2px;
    }
</style>
<link href="@Url.Content("~/Content/formStyle.css")"  rel="Stylesheet" />
@section Title{
Ad Setup
}
@section headscript{
    <script src="@Url.Content("~/Scripts/jquery.maskedinput-1.3.js")" type="text/javascript"></script>
}
@section SectionNav{
    <div id="examplesThemeChooser">
        Step 1 of 3
        <input type="button" class="k-button k-state-btnerror rounded" value="1" id="btnOne" />
        <input type="button" class="k-button rounded" value="2" id="btnTwo" />
        <input type="button" class="k-button rounded" value="3" id="btnThree" />
    </div>
}
@section Navbar{
<script src="@Url.Content("~/Scripts/PanelBar.js")" type="text/javascript"> </script>
    <ul id="panelbar-images">
        <li><span>Home</span>
            <ul>
                <li>@Html.ActionLink("My Account", "Index2", "Home")</li>
                <li>@Html.ActionLink("Ad Setup", "CampaignSetup")</li>
                <li>@Html.ActionLink("Reporting", "Index", "Reporting")</li>
                <li>@Html.ActionLink("Billing", "CampaignSetup")</li>
                <li>@Html.ActionLink("My Profile", "MyProfile", "Account")</li>
            </ul>
        </li>
        <li><span>
            @Model.Configuration.DefaultProductGroupName
        </span>
            <div style="height: 476px;" class="k-treeview">
                <ul id="treeview">
                </ul>
            </div>
        </li>
    </ul>
    
}
<div id="exampleWrap">
    <div id="example" class="k-content">
        @using (Ajax.BeginForm("CampaignSetup", "Campaign", new AjaxOptions { HttpMethod = "Post", OnSuccess = "OnSuccess", OnBegin = "OnBegin", OnFailure = "OnFailure" }))
        {
            @Html.ValidationSummary(true)
            <div id="tabstrip">
                <ul>
                    <li class="k-state-active">DEFINE PRODUCT</li>
                    <li>CREATE ADS</li>
                </ul>
                <div>
                    @Html.EditorFor(t => t.ProductGroup)
                </div>
                <div>
                    @Html.EditorFor(t => t.AdModelProp)
                </div>
            </div>
            <input type="hidden" id="ViewSelectedKeywordsUrl" value='@System.Configuration.ConfigurationManager.AppSettings["ViewSelectedKeywordsUrl"]'/>
            <input type="hidden" id="NegativeKeyWordsUrl" value='@System.Configuration.ConfigurationManager.AppSettings["NegativeKeyWordsUrl"]'/>
            <input type="hidden" id="AdditionalSiteLinksUrl" value='@System.Configuration.ConfigurationManager.AppSettings["AdditionalSiteLinksUrl"]'/>
            <input type="hidden" id="SideBarUrl" value='@System.Configuration.ConfigurationManager.AppSettings["SideBarUrl"]'/>
        }
    </div>
</div>
<script type="text/javascript">
    $.getJSON($('#SideBarUrl').val(), {}, function (data) {
        for (var mainGroup in data) {
            for (var subitem in data[mainGroup].SubItems) {
                var items = [];
                for (var subitem1 in data[mainGroup].SubItems[subitem].SubItems) {
                    items[subitem1] = ({ text: data[mainGroup].SubItems[subitem].SubItems[subitem1].Name, url: data[mainGroup].SubItems[subitem].SubItems[subitem1].Url });
                }
                treeview.append({ text: data[mainGroup].SubItems[subitem].Name, url: data[mainGroup].SubItems[subitem].Url, items: items });
            }
        }
    });
    var panelBar = $("#panelbar-images").kendoPanelBar({
        expandMode: "single"
    }).data("kendoPanelBar");
    var treeview = $("#treeview").kendoTreeView().data("kendoTreeView");
    $("#panelbar-images").on("click", ".k-in", function (e) {
        treeview.toggle($(e.target).closest(".k-item"));
    });
    $("#panelbar-profile").kendoPanelBar({
        dataSource: [
            {
                text: "Home",
                items: [
                    { text: "Reporting" },
                    { text: "Billing" },
                    { text: "Quick Start Guide" },
                    { text: "FAQs" },
                    { text: "Contact Us" }
                ]
            }
        ],
        expandMode: "single"
    });
    var onActivate = function () {
        switch (tabStrip.select().text()) {
            case "DEFINE PRODUCT":
                $("input[type='button']#btnOne").addClass('k-state-btnerror');
                $("input[type='button']#btnTwo").removeClass('k-state-btnerror');
                $("input[type='button']#btnThree").removeClass('k-state-btnerror');
                break;
            case "CREATE ADS":
                $("input[type='button']#btnOne").removeClass('k-state-btnerror');
                $("input[type='button']#btnTwo").addClass('k-state-btnerror');
                $("input[type='button']#btnThree").removeClass('k-state-btnerror');
                break;
            case 'Additional Click Through Links("SiteLinks")':
                $("input[type='button']#btnOne").removeClass('k-state-btnerror');
                $("input[type='button']#btnTwo").removeClass('k-state-btnerror');
                $("input[type='button']#btnThree").addClass('k-state-btnerror');
                break;
            case "Negative Keywords":
                $("input[type='button']#btnOne").removeClass('k-state-btnerror');
                $("input[type='button']#btnTwo").removeClass('k-state-btnerror');
                $("input[type='button']#btnThree").removeClass('k-state-btnerror');
                break;
        }
    };

    //Generate Tab
    var tabStrip = $("#tabstrip").kendoTabStrip({ activate: onActivate }).data("kendoTabStrip");

    // Start Enable tabs region
    var tab = tabStrip.select();

    tabStrip.enable(tab.next(), tab.next().hasClass("k-state-disabled"));

    function OnBegin() {
        //alert('Success');
        $.blockUI({ message: '<h1><img src="@Url.Content("~/Content/Metro/loading.gif")" /> Just a moment...</h1>'
        });
    }
    function OnSuccess(id) {
        $.unblockUI();
        var tab;
        //alert(id);
        if (id == "Categories") {
            if (!tabStrip.tabGroup.children('li:contains("' + id + '")').text()) {
                tabStrip.append({
                    text: "Categories",
                    contentUrl: '@Url.Action("Categories")'
                }, tabStrip.tabGroup.children("li:last")).select();
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            } else {
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            }
        }
        else if (id == "BillingLaunch") {
            if (!tabStrip.tabGroup.children('li:contains("' + id + '")').text()) {
                tabStrip.append({
                    text: "BillingLaunch",
                    contentUrl: '@Url.Action("BillingLaunch")'
                }, tabStrip.tabGroup.children("li:last")).select();
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            } else {
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            }
        }
        else if (id == "AdditionalLinks" || id == "NegativeKeywords" || id  == "Keywords") {
        //alert('addlinks_negkeywords');
            tab = tabStrip.select();
            var otherTab = tab.prev();
            tabStrip.remove(tab);
            tabStrip.select(otherTab);
        }
        else { alert(id); }

    }
    function OnFailure(ajaxContext) {
        $.unblockUI();
        //        var response = ajaxContext.responseText;
        //        alert(response);
    }

</script>
<script src="@Url.Content("~/Scripts/CampaignSetup.js")" type="text/javascript"> </script>
<script src="@Url.Content("~/Scripts/AdditionalLinks.js")" type="text/javascript"> </script>​