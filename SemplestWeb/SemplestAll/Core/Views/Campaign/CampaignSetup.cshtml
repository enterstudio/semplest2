@model Semplest.Core.Models.CampaignSetupModel
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"> </script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.js")" type="text/javascript"> </script>
<script src="@Url.Content("~/Scripts/conditional-validation.js")" type="text/javascript"></script>
@Html.AntiForgeryToken()
@{}
<style>
    .enddate
    {
        display: none;
        visibility: hidden;
    }
    .expand-padding
    {
        padding-right: 2px;
    }
</style>
<link href="@Url.Content("~/Content/formStyle.css")"  rel="Stylesheet" />
@section Title{
    Ad Setup (@ViewBag.Title)
}
@section headscript{
    <script src="@Url.Content("~/Scripts/jquery.maskedinput-1.3.js")" type="text/javascript"></script>
}
@section SectionNav{
    <div id="examplesThemeChooser">
        Step 1 of 3
        <input type="button" class="k-button k-state-btnerror rounded" value="1" id="btnOne" />
        <input type="button" class="k-button rounded" value="2" id="btnTwo" />
        <input type="button" class="k-button rounded" value="3" id="btnThree" />
    </div>
}
<div>
    <div id="example">
        @using (Ajax.BeginForm("CampaignSetup", "Campaign", new AjaxOptions { HttpMethod = "Post", OnSuccess = "OnSuccess", OnBegin = "OnBegin", OnFailure = "OnFailure" }))
        {
            @Html.ValidationSummary(true)
            <div id="tabstrip">
                <ul>
                    <li class="k-state-active">Define Product</li>
                    <li>Create Ads</li>
                </ul>
                <div>
                    @Html.EditorFor(t => t.ProductGroup)
                </div>
                <div>
                    @Html.EditorFor(t => t.AdModelProp)
                </div>
            </div>
            <input type="hidden" id="ViewSelectedKeywordsUrl" value='@System.Configuration.ConfigurationManager.AppSettings["ViewSelectedKeywordsUrl"]'/>
            <input type="hidden" id="NegativeKeyWordsUrl" value='@System.Configuration.ConfigurationManager.AppSettings["NegativeKeyWordsUrl"]'/>
            <input type="hidden" id="AdditionalSiteLinksUrl" value='@System.Configuration.ConfigurationManager.AppSettings["AdditionalSiteLinksUrl"]'/>
            <input type="hidden" id="SideBarUrl" value='@System.Configuration.ConfigurationManager.AppSettings["SideBarUrl"]'/>
            <input type="hidden" id="LogoUrlStr" value='@System.Configuration.ConfigurationManager.AppSettings["LogoUrl"]'/>
            <img id="displayBox" style="display: none" />
        }
    </div>
</div>
<script type="text/javascript">

    var onActivate = function () {
        switch (tabStrip.select().text()) {
            case "Define Product":
                $("input[type='button']#btnOne").addClass('k-state-btnerror');
                $("input[type='button']#btnTwo").removeClass('k-state-btnerror');
                $("input[type='button']#btnThree").removeClass('k-state-btnerror');
                break;
            case "Create Ads":
                for (var map in mapArray) {
                    L.Util.requestAnimFrame(mapArray[map].invalidateSize, mapArray[map], !1, mapArray[map]._container);
                }
                $("input[type='button']#btnOne").removeClass('k-state-btnerror');
                $("input[type='button']#btnTwo").addClass('k-state-btnerror');
                $("input[type='button']#btnThree").removeClass('k-state-btnerror');
                break;
            case 'Additional Click Through Links("SiteLinks")':
                $("input[type='button']#btnOne").removeClass('k-state-btnerror');
                $("input[type='button']#btnTwo").removeClass('k-state-btnerror');
                $("input[type='button']#btnThree").addClass('k-state-btnerror');
                break;
            case "Negative Keywords":
                $("input[type='button']#btnOne").removeClass('k-state-btnerror');
                $("input[type='button']#btnTwo").removeClass('k-state-btnerror');
                $("input[type='button']#btnThree").removeClass('k-state-btnerror');
                break;
        }
    };

    //Generate Tab
    var tabStrip = $("#tabstrip").kendoTabStrip({ activate: onActivate }).data("kendoTabStrip");

    // Start Enable tabs region
    var tab = tabStrip.select();

    tabStrip.enable(tab.next(), tab.next().hasClass("k-state-disabled"));

    function OnBegin() {
        var urlStr = $('#LogoUrlStr').val() + 'congratulations.jpg';
        if (urlStr == $('#displayBox').attr('src')) {
            $.blockUI({ message: '<div><img src ="' + urlStr + '" /><div style="text-align:center"><button class="k-button" id="btnCongrats">Ok</button></div></div>', css: {
                top: ($(window).height() - $('#displayBox')[0].naturalHeight) / 2 + 'px',
                left: ($(window).width() - $('#displayBox')[0].naturalWidth) / 2 + 'px',
                width: $('#displayBox')[0].naturalWidth + 'px',
                border: '0px solid #aaa'
            }
            });
        }
        else
            $.blockUI({ message: $('#displayBox'), css: {
                top: ($(window).height() - $('#displayBox')[0].naturalHeight) / 2 + 'px',
                left: ($(window).width() - $('#displayBox')[0].naturalWidth) / 2 + 'px',
                width: $('#displayBox')[0].naturalWidth + 'px',
                border: '0px solid #aaa'
            }
            });
    }

    $('#btnCongrats').live("click", function () {
        $.unblockUI();
    });
    function OnSuccess(id) {
        if ($('#displayBox').attr('src') != $('#LogoUrlStr').val() + 'congratulations.jpg')
            $.unblockUI();
        var tab;
        //alert(id);
        if (id == "Categories") {
            if (!tabStrip.tabGroup.children('li:contains("' + id + '")').text()) {
                tabStrip.append({
                    text: "Categories",
                    contentUrl: '@Url.Action("Categories")'
                }, tabStrip.tabGroup.children("li:last")).select();
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            } else {
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            }
        }
        else if (id == "BillingLaunch") {
            if (!tabStrip.tabGroup.children('li:contains("' + id + '")').text()) {
                tabStrip.append({
                    text: "BillingLaunch",
                    contentUrl: '@Url.Action("BillingLaunch")'
                }, tabStrip.tabGroup.children("li:last")).select();
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            } else {
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            }
        }
        else if (id == "AdditionalLinks" || id == "NegativeKeywords" || id == "Keywords") {
            //alert('addlinks_negkeywords');
            tab = tabStrip.select();
            var otherTab = tab.prev();
            tabStrip.remove(tab);
            tabStrip.select(otherTab);
        }
        else {
            if (id != "")
                alert(id);
        }

    }
    function OnFailure() {
        $.unblockUI();
    }
</script>
<script src="@Url.Content("~/Scripts/CampaignSetup.js")" type="text/javascript"> </script>
<script src="@Url.Content("~/Scripts/AdditionalLinks.js")" type="text/javascript"> </script>
<script src="@Url.Content("~/Scripts/QuestionMarkHelp.js")" type="text/javascript"> </script>
