@model Semplest.Core.Models.CampaignSetupModel
@Html.AntiForgeryToken()
@{
    ViewBag.Title = "Campaign";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .enddate
    {
        display: none;
        visibility: hidden;
    }
</style>
<link href="@Url.Content("~/Content/formStyle.css")"  rel="Stylesheet" />
@section Title{
Ad Setup
}
@section Links{
    <div id="examplesThemeChooser">
        Step 1 of 3
        <input type="button" class="k-button k-state-btnerror rounded" value="1" id="btnOne" />
        <input type="button" class="k-button rounded" value="2" id="btnTwo" />
        <input type="button" class="k-button rounded" value="3" id="btnThree" />
    </div>
}
@section Navbar{
    <div id="panelbar-images">
    </div>
    <script src="@Url.Content("~/Scripts/PanelBar.js")" type="text/javascript"> </script>
}
<div id="exampleWrap">
    <div id="example" class="k-content">
        @*@using (Ajax.BeginForm("CampaignSetup", "Campaign", new AjaxOptions { HttpMethod = "Post", OnSuccess = "OnSuccess", UpdateTargetId = "example" }))*@
        @*@using (Html.BeginForm("CampaignSetup", "Campaign"))*@
        @using (Ajax.BeginForm("CampaignSetup", "Campaign", new AjaxOptions { HttpMethod = "Post", OnSuccess = "OnSuccess", OnBegin = "OnBegin" }))
        {
            @Html.ValidationSummary(true, "Campaign creation was unsuccessful. Please correct the errors and try again.")
            <div id="tabstrip">
                <ul>
                    <li class="k-state-active">DEFINE PRODUCT</li>
                    <li>CREATE ADS</li>
                </ul>
                <div>
                    @Html.EditorFor(t => t.ProductGroup)
                </div>
                <div id="product-view" class="k-header">
                    @Html.Partial("AdModel", Model)
                </div>
            </div>
        }
    </div>
</div>
<script type="text/javascript">
    var onActivate = function () {
        switch (tabStrip.select().text()) {
            case "DEFINE PRODUCT":
                $("input[type='button']#btnOne").addClass('k-state-btnerror');
                $("input[type='button']#btnTwo").removeClass('k-state-btnerror');
                $("input[type='button']#btnThree").removeClass('k-state-btnerror');
                break;
            case "CREATE ADS":
                $("input[type='button']#btnOne").removeClass('k-state-btnerror');
                $("input[type='button']#btnTwo").addClass('k-state-btnerror');
                $("input[type='button']#btnThree").removeClass('k-state-btnerror');
                break;
            case 'Additional Click Through Links("SiteLinks")':
                $("input[type='button']#btnOne").removeClass('k-state-btnerror');
                $("input[type='button']#btnTwo").removeClass('k-state-btnerror');
                $("input[type='button']#btnThree").addClass('k-state-btnerror');
                break;
            case "Negative Keywords":
                $("input[type='button']#btnOne").removeClass('k-state-btnerror');
                $("input[type='button']#btnTwo").removeClass('k-state-btnerror');
                $("input[type='button']#btnThree").removeClass('k-state-btnerror');
                break;
        }
    };

    //Generate Tab
    var tabStrip = $("#tabstrip").kendoTabStrip({ activate: onActivate }).data("kendoTabStrip");

    // Start Enable tabs region
    var tab = tabStrip.select();

    //tabStrip.enable(tab.next(), tab.next().hasClass("k-state-disabled"));

    function OnBegin() {
        //alert('Success');
        $.blockUI({ message: '<h1><img src="@Url.Content("~/Content/Metro/loading.gif")" /> Just a moment...</h1>' });
    }
    function OnSuccess(id) {
        $.unblockUI();
        var tab;
        if (id == "Categories") {
            if (!tabStrip.tabGroup.children('li:contains("' + id + '")').text()) {
                tabStrip.append({
                    text: "Categories",
                    contentUrl: '@Url.Action("Categories")'
                }, tabStrip.tabGroup.children("li:last")).select();
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            } else {
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            }
        }
        else if (id == "BillingLaunch") {
            if (!tabStrip.tabGroup.children('li:contains("' + id + '")').text()) {
                tabStrip.append({
                    text: "BillingLaunch",
                    contentUrl: '@Url.Action("BillingLaunch")'
                }, tabStrip.tabGroup.children("li:last")).select();
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            } else {
                tab = tabStrip.tabGroup.children('li:contains("' + id + '")');
                tabStrip.select(tab);
            }
        }
    }
    function OnFailure(ajaxContext) {
        $.unblockUI();
        var response = ajaxContext.get_response();
        var statusCode = response.get_statusCode();
        alert('Failure');
        $('#example').empty();
    }

</script>
<script src="@Url.Content("~/Scripts/CampaignSetup.js")" type="text/javascript"> </script>
